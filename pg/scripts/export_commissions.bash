#!/bin/bash

FN="iso-commissions.csv"

#GFENY
USER='mcamaster'
PASSWD='xxxxx'
DB='postgres'
HOST='mca1-1-instance-1.cxrgcmhggkds.us-west-2.rds.amazonaws.com'
SCHEMA='gfeny'
OWNER='mcamaster'

SQL='
select dest.mcaid, tr.id, tr.ammount, tr.effectivedate, pr.firstname, pr.lastname
from gfeny.transaction tr, gfeny.transcrosref cr, gfeny.transaction dest, gfeny.person pr
where tr.id=cr.transid and cr.refid=dest.id
and dest.status=8
and tr.status in (8,13)
and dest.transtype=11
and pr.id=tr.userid
and dest.mcaid in (
72,
74,
89,
98,
397,
435,
436,
451,
498,
559,
598,
631,
693,
703,
706,
709,
719,
792,
891,
1056,
1078,
1080,
1116,
1201,
1212,
1250,
1256,
1347,
1462,
1587,
1596,
1701,
1751,
1781,
1816,
1901,
1906,
1947,
2038,
2048,
2180,
2191,
2237,
2350,
2396,
2406,
2460,
2685,
2697,
2763,
2784,
2908,
3059,
3071,
3096,
3106,
3163,
3213,
3384,
3501,
3636,
3708,
3742,
3863,
3879,
3953,
4006,
4195,
4237,
4274,
4320,
4390,
4466,
4576,
4668,
4684,
4693,
4727,
4901,
5048,
5290,
5379,
5492,
5555,
5613,
5674,
5720,
5944,
5948,
5994,
6117,
6192,
6225,
6302,
6307,
6387,
6404,
6449,
6473,
6495,
6541,
6600,
6611,
6901,
7061,
7128,
7248,
7322,
7365,
7451,
7536,
7699,
7869,
7905,
7927,
7929,
7930,
8068,
8215,
8293,
8316,
8391,
8544,
8982,
9171,
9183,
9452,
9454,
9455,
9547,
9554,
9596,
9603,
9620,
9727,
9801,
9801,
9857,
9890,
10012,
10038,
10050,
10129,
10544,
10724,
10816,
10929,
11106,
11675,
11912,
11933,
12652,
14206,
15257,
15790
)
order by dest.mcaid;
'
PGPASSWORD=${PASSWD}  psql -h ${HOST} -U ${USER} -d ${DB} -c "${SQL}" > ${FN}
